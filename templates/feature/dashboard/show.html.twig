{% extends 'base.html.twig' %}

{# @var DashboardService \App\Service\Feature\Dashboard\DashboardService #}

{% block title %}{{ 'mainnav.dashboard'|trans }}{% endblock %}
{% block contentTitle %}{{ 'mainnav.dashboard'|trans }}{% endblock %}

{% block body %}

    {% embed 'embeds/default_content_box.html.twig' %}
        {% block contentBoxTitle %}
            {{ 'feature.dashboard.show.your_info'|trans }}
        {% endblock %}

        {% block contentBoxSubtitle %}
            {{ 'feature.dashboard.show.your_info_subtitle'|trans }}
        {% endblock %}

        {% block contentBoxContent %}
            <div class="collection-box">

                {% if DashboardService.firstName(app.user) is not null
                    and DashboardService.lastName(app.user) is not null
                %}
                    {% embed 'embeds/two_column_content_box_content_row.html.twig' with { odd: true, colspanLeft: 4, colspanRight: 8 } %}
                        {% block contentLeft %}
                            {{ 'feature.dashboard.show.your_name'|trans }}
                        {% endblock %}
                        {% block contentRight %}
                            {{ DashboardService.firstName(app.user) }}
                            {{ DashboardService.lastName(app.user) }}
                        {% endblock %}
                    {% endembed %}
                {% endif %}

                {% embed 'embeds/two_column_content_box_content_row.html.twig' with { odd: false, colspanLeft: 4, colspanRight: 8 } %}
                    {% block contentLeft %}
                        {{ 'feature.dashboard.show.your_email_address'|trans }}
                    {% endblock %}
                    {% block contentRight %}
                        {{ DashboardService.email(app.user) }}
                    {% endblock %}
                {% endembed %}

                {% embed 'embeds/two_column_content_box_content_row.html.twig' with { odd: true, colspanLeft: 4, colspanRight: 8 } %}
                    {% block contentLeft %}
                        {{ 'feature.dashboard.show.your_subscription'|trans }}
                    {% endblock %}
                    {% block contentRight %}
                        {{ ('feature.dashboard.show.subscription.' ~ DashboardService.subscriptionPlan(app.user) ~ '.title')|trans }}
                        <div class="mt-1 text-sm text-gray-500 sm:mt-0 sm:col-span-2">
                            {{ ('feature.dashboard.show.subscription.' ~ DashboardService.subscriptionPlan(app.user) ~ '.description')|trans }}
                        </div>
                    {% endblock %}
                {% endembed %}

                {% if DashboardService.latestVideos(app.user)|length > 0 %}
                    {% embed 'embeds/two_column_content_box_content_row.html.twig' with { odd: false, colspanLeft: 4, colspanRight: 8 } %}
                        {% block contentLeft %}
                            {{ 'feature.dashboard.show.your_latest_videos'|trans }}
                        {% endblock %}
                        {% block contentRight %}
                            <ul role="list" class="border border-gray-200 rounded-md divide-y divide-gray-200">

                                {% for video in DashboardService.latestVideos(app.user) %}
                                    {# @var video \App\Entity\Feature\Recordings\Video  #}
                                    <li class="pl-3 pr-4 py-3 flex items-center justify-between text-sm">
                                        <div class="w-0 flex-1 flex items-center">
                                            <!-- Heroicon name: outline/film -->
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" />
                                            </svg>
                                            <span class="ml-2 flex-1 w-0 truncate">
                                            {{ 'dateformat.datetime_normal'|trans({ 'date': video.createdAt|format_datetime('long', 'short', locale=app.request.locale, timezone=client_timezone) }) }}
                                        </span>
                                        </div>
                                        <div class="ml-4 flex-shrink-0">
                                            <a href="{{ path('feature.recordings.videos.overview') }}" class="font-medium text-indigo-600 hover:text-indigo-500">
                                                {{ 'feature.dashboard.show.cta.manage_video'|trans }}
                                            </a>
                                        </div>
                                    </li>
                                {% endfor %}

                            </ul>
                        {% endblock %}
                    {% endembed %}
                {% endif %}

                {% embed 'embeds/two_column_content_box_content_row.html.twig' with { odd: true, colspanLeft: 4, colspanRight: 8 } %}
                    {% block contentLeft %}
                        {{ 'feature.dashboard.show.your_presentationpages'|trans }}
                    {% endblock %}
                    {% block contentRight %}
                        <a href="{{ path('feature.presentationpages.overview') }}">
                            {{ 'feature.dashboard.show.your_presentationpages.info'|trans(
                                { numberOfPresentationpages: DashboardService.numberOfPresentationpages(app.user, constant('\\App\\Entity\\Feature\\Presentationpages\\PresentationpageType::Page')) }
                            ) }}
                        </a>
                    {% endblock %}
                {% endembed %}

            </div>
        {% endblock %}
    {% endembed %}

{% endblock %}
